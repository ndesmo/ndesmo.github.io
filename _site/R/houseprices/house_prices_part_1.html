

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>House prices: part one</title>
    
    <meta name="author" content="Name Lastname">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/css/1.4.0/bootstrap.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>

    <div class="topbar">
      <div class="fill">
        <div class="container">
          <a class="brand" href="/">Jekyll Bootstrap</a>
          <ul class="nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/archive">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags">Tags</a></li>
      	
      
    
  
    
      
    
  
    
  
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container">

      <div class="content">
        

<div class="page-header">
  <h1>House prices: part one <small>Supporting tagline</small></h1>
</div>

<div class="row">
  <div class="span10">
    <h2 id="overview">Overview</h2>

<p>In the following few posts I will be doing simple exploratory data analysis of the <a href="https://ww2.amstat.org/publications/jse/v19n3/decock.pdf">Ames Housing dataset</a> used in the Kaggle competition <a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques">House Prices: Advanced Regression Techniques</a>. In later posts, I will go on to run statistical models on the data. This is my first blog post here so it’s also an exercise in creating blog posts!</p>

<p>The problem is to try to correctly predict the house prices in the test dataset by training a regression model on the training data.</p>

<p>I will soon do an exploratory data analysis of the data, however to begin with, the data should be cleaned. In particular, the empty values should be filled in.</p>

<p>First, let’s load the data.</p>

<pre><code class="language-r">library(dplyr)
library(ggplot2)
library(reshape2)

train &lt;- read.csv('train.csv', stringsAsFactors = F)
test &lt;- read.csv('test.csv', stringsAsFactors = F)
</code></pre>

<h3 id="columns">Columns</h3>

<p>Here are the columns available in the dataset:</p>

<pre><code class="language-r">names(train)
</code></pre>

<pre><code>##  [1] "Id"            "MSSubClass"    "MSZoning"      "LotFrontage"  
##  [5] "LotArea"       "Street"        "Alley"         "LotShape"     
##  [9] "LandContour"   "Utilities"     "LotConfig"     "LandSlope"    
## [13] "Neighborhood"  "Condition1"    "Condition2"    "BldgType"     
## [17] "HouseStyle"    "OverallQual"   "OverallCond"   "YearBuilt"    
## [21] "YearRemodAdd"  "RoofStyle"     "RoofMatl"      "Exterior1st"  
## [25] "Exterior2nd"   "MasVnrType"    "MasVnrArea"    "ExterQual"    
## [29] "ExterCond"     "Foundation"    "BsmtQual"      "BsmtCond"     
## [33] "BsmtExposure"  "BsmtFinType1"  "BsmtFinSF1"    "BsmtFinType2" 
## [37] "BsmtFinSF2"    "BsmtUnfSF"     "TotalBsmtSF"   "Heating"      
## [41] "HeatingQC"     "CentralAir"    "Electrical"    "X1stFlrSF"    
## [45] "X2ndFlrSF"     "LowQualFinSF"  "GrLivArea"     "BsmtFullBath" 
## [49] "BsmtHalfBath"  "FullBath"      "HalfBath"      "BedroomAbvGr" 
## [53] "KitchenAbvGr"  "KitchenQual"   "TotRmsAbvGrd"  "Functional"   
## [57] "Fireplaces"    "FireplaceQu"   "GarageType"    "GarageYrBlt"  
## [61] "GarageFinish"  "GarageCars"    "GarageArea"    "GarageQual"   
## [65] "GarageCond"    "PavedDrive"    "WoodDeckSF"    "OpenPorchSF"  
## [69] "EnclosedPorch" "X3SsnPorch"    "ScreenPorch"   "PoolArea"     
## [73] "PoolQC"        "Fence"         "MiscFeature"   "MiscVal"      
## [77] "MoSold"        "YrSold"        "SaleType"      "SaleCondition"
## [81] "SalePrice"
</code></pre>

<p>The last column “SalePrice” is the one we will be measuring so we won’t include this in the full set. We bin the ID column straight away as it’s not needed.</p>

<pre><code class="language-r">full &lt;-
  train %&gt;% select(-Id, -SalePrice) %&gt;%
  bind_rows(test %&gt;% select(-Id))
</code></pre>

<h2 id="data-cleaning">Data cleaning</h2>

<p>We look for missing values and try to fill these in</p>

<pre><code class="language-r">full %&gt;% 
  select(which(sapply(full, function(x)any(is.na(x))))) %&gt;%
  sapply(function(x)sum(ifelse(is.na(x), 1, 0))) %&gt;%
  sort(decreasing=T)
</code></pre>

<pre><code>##       PoolQC  MiscFeature        Alley        Fence  FireplaceQu 
##         2909         2814         2721         2348         1420 
##  LotFrontage  GarageYrBlt GarageFinish   GarageQual   GarageCond 
##          486          159          159          159          159 
##   GarageType     BsmtCond BsmtExposure     BsmtQual BsmtFinType2 
##          157           82           82           81           80 
## BsmtFinType1   MasVnrType   MasVnrArea     MSZoning    Utilities 
##           79           24           23            4            2 
## BsmtFullBath BsmtHalfBath   Functional  Exterior1st  Exterior2nd 
##            2            2            2            1            1 
##   BsmtFinSF1   BsmtFinSF2    BsmtUnfSF  TotalBsmtSF   Electrical 
##            1            1            1            1            1 
##  KitchenQual   GarageCars   GarageArea     SaleType 
##            1            1            1            1
</code></pre>

<h3 id="poolqc-missing-values">PoolQC missing values</h3>

<pre><code class="language-r">full %&gt;%
  select(PoolQC) %&gt;%
  group_by(PoolQC) %&gt;%
  summarise(Count = n())
</code></pre>

<pre><code>## # A tibble: 4 × 2
##   PoolQC Count
##    &lt;chr&gt; &lt;int&gt;
## 1     Ex     4
## 2     Fa     2
## 3     Gd     4
## 4   &lt;NA&gt;  2909
</code></pre>

<p>What to fill in the NA’s with? We will go for a default missing value. The data dictionary says that ‘NA’ means “no pool” so we’ll go with that.</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  mutate(PoolQC = ifelse(is.na(PoolQC), 'None', PoolQC))
</code></pre>

<p>What is the situation with PoolArea?</p>

<pre><code class="language-r">full %&gt;% filter(PoolQC == 'None', PoolArea &gt; 0) %&gt;% select(PoolArea)
</code></pre>

<pre><code>##   PoolArea
## 1      368
## 2      444
## 3      561
</code></pre>

<p>There are 3 instances of Pools with non-zero area but “don’t exist”. To fix this let’s look at the relationship between PoolQC and PoolArea</p>

<pre><code class="language-r">full %&gt;%
  filter(PoolQC != 'None') %&gt;% 
  ggplot(aes(x=factor(PoolQC), y=PoolArea)) + 
  geom_boxplot(fill='cornflowerblue')
</code></pre>

<p><img src="house_prices_part_1_files/figure-markdown_github/poolqc-poolarea-1.png" alt="" /></p>

<p>So it looks like the 3 cases of non-existent pools with area &gt; 0 should all be given PoolQC = ‘Ex’</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  mutate(PoolQC = ifelse(PoolQC == 'None' &amp; PoolArea &gt; 0, 'Ex', PoolQC))
</code></pre>

<h3 id="miscfeature-missing-values">MiscFeature missing values</h3>

<p>Next on the list is MiscFeature. The data dictionary describes this as “Miscellaneous feature not covered in other categories”. Lets do a count of each value:</p>

<pre><code class="language-r">full %&gt;%
  group_by(MiscFeature) %&gt;%
  summarise(Count = n())
</code></pre>

<pre><code>## # A tibble: 5 × 2
##   MiscFeature Count
##         &lt;chr&gt; &lt;int&gt;
## 1        Gar2     5
## 2        Othr     4
## 3        Shed    95
## 4        TenC     1
## 5        &lt;NA&gt;  2814
</code></pre>

<p>I think we’re good to go ahead and fill in the missing values of MiscFeature with ‘None’.</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  mutate(MiscFeature = ifelse(is.na(MiscFeature), 'None', MiscFeature))
</code></pre>

<h3 id="miscfeature-second-garages">MiscFeature Second Garages</h3>

<p>Value of Gar2 means there is a second Garage. Let’s check whether this is accurately represented in the data</p>

<pre><code class="language-r">full  %&gt;%
  filter(MiscFeature == 'Gar2')%&gt;% 
  select(GarageType, GarageYrBlt, GarageFinish, GarageCars, GarageArea, GarageQual, GarageCond)
</code></pre>

<pre><code>##   GarageType GarageYrBlt GarageFinish GarageCars GarageArea GarageQual
## 1     Attchd        1960          RFn          1        301         TA
## 2    BuiltIn        1977          RFn          2        600         TA
## 3     Attchd        1958          Unf          1        312         TA
## 4     Attchd        1953          RFn          1        286         TA
## 5     Detchd        2002          Unf          2        624         TA
##   GarageCond
## 1         TA
## 2         TA
## 3         TA
## 4         TA
## 5         TA
</code></pre>

<p>Good, so there’s no existence of 2nd garages without a first. However I wonder if there are garages with more Cars in them without room for them.</p>

<pre><code class="language-r">full %&gt;% ggplot(aes(x = GarageArea, y=GarageCars)) + geom_point(colour = 'cornflowerblue')
</code></pre>

<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).
</code></pre>

<p><img src="house_prices_part_1_files/figure-markdown_github/cars-garage-1.png" alt="" /></p>

<p>This looks to be behaving well. There dont seem to be any outliers towards the left and top of the graph.</p>

<h3 id="fireplacequ-missing-values">FireplaceQu missing values</h3>

<p>We use the Fireplaces column to fix the FireplaceQu missing values</p>

<pre><code class="language-r">full %&gt;%
  filter(is.na(FireplaceQu), Fireplaces &gt; 0) %&gt;%
  select(Fireplaces, FireplaceQu)
</code></pre>

<pre><code>## [1] Fireplaces  FireplaceQu
## &lt;0 rows&gt; (or 0-length row.names)
</code></pre>

<p>Hence, we assign all blank FireplaceQu to ‘None’.</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  mutate(FireplaceQu = ifelse(is.na(FireplaceQu), 'None', FireplaceQu))
</code></pre>

<h3 id="lotfrontage-missing-values">LotFrontage missing values</h3>

<p>Does lack of a value mean 0 feet as lot frontage?</p>

<pre><code class="language-r">full %&gt;%
  filter(is.na(LotFrontage) | LotFrontage == 0) %&gt;%
  summarise(Count = n())
</code></pre>

<pre><code>##   Count
## 1   486
</code></pre>

<p>Since there are only NA’s and no 0’s then let’s assume so</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  mutate(LotFrontage = ifelse(is.na(LotFrontage), 0, LotFrontage))
</code></pre>

<h3 id="garages">Garages</h3>

<pre><code class="language-r">full %&gt;%
  filter(is.na(GarageType) |
           is.na(GarageYrBlt) |
           is.na(GarageFinish) |
           is.na(GarageCars) |
           is.na(GarageArea) |
           is.na(GarageQual) |
           is.na(GarageCond)) %&gt;%
  group_by(GarageType, GarageYrBlt, GarageFinish, GarageCars,
           GarageArea, GarageQual, GarageCond) %&gt;%
  summarise(Count = n()) %&gt;%
  knitr::kable()
</code></pre>

<table>
  <thead>
    <tr>
      <th style="text-align: left">GarageType</th>
      <th style="text-align: right">GarageYrBlt</th>
      <th style="text-align: left">GarageFinish</th>
      <th style="text-align: right">GarageCars</th>
      <th style="text-align: right">GarageArea</th>
      <th style="text-align: left">GarageQual</th>
      <th style="text-align: left">GarageCond</th>
      <th style="text-align: right">Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Detchd</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">360</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">Detchd</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">157</td>
    </tr>
  </tbody>
</table>

<p>So we have 2 cases of Detached garages, 1 with entries for GarageCars and GarageArea, and another for no other Garage entries. We also have 157 cases where there are no entries for anything, so this looks like no garage.</p>

<p>We’ll fill in the “no garages” first. For the year we will use the YearBuilt</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  transform(GarageType = ifelse(is.na(GarageType), 'None', GarageType),
            GarageYrBlt = ifelse(is.na(GarageYrBlt), YearBuilt, GarageYrBlt),
            GarageFinish = ifelse(is.na(GarageFinish), 'None', GarageFinish),
            GarageCars = ifelse(is.na(GarageCars), 'None', 0),
            GarageArea = ifelse(is.na(GarageArea), 'None', 0),
            GarageQual = ifelse(is.na(GarageQual), 'None', GarageQual),
            GarageCond = ifelse(is.na(GarageCond), 'None', GarageCond))
</code></pre>

<h3 id="basements-cleaning">Basements cleaning</h3>

<p>Next up, the basement. Let’s see where the null values occur</p>

<pre><code class="language-r">full %&gt;%
  filter(is.na(BsmtQual) |
           is.na(BsmtCond) |
           is.na(BsmtExposure) |
           is.na(BsmtFinType1) |
           is.na(BsmtFinSF1) |
           is.na(BsmtFinType2) |
           is.na(BsmtFinSF2) | 
           is.na(BsmtUnfSF) |
           is.na(BsmtFullBath) |
           is.na(BsmtHalfBath) |
           is.na(TotalBsmtSF)) %&gt;%
  group_by(BsmtQual, BsmtCond, BsmtExposure, BsmtFinType1, BsmtFinSF1,
           BsmtFinType2, BsmtFinSF2, BsmtUnfSF, BsmtFullBath, BsmtHalfBath,
           TotalBsmtSF) %&gt;%
  summarise(Count = n()) %&gt;%
  knitr::kable()
</code></pre>

<table>
  <thead>
    <tr>
      <th style="text-align: left">BsmtQual</th>
      <th style="text-align: left">BsmtCond</th>
      <th style="text-align: left">BsmtExposure</th>
      <th style="text-align: left">BsmtFinType1</th>
      <th style="text-align: right">BsmtFinSF1</th>
      <th style="text-align: left">BsmtFinType2</th>
      <th style="text-align: right">BsmtFinSF2</th>
      <th style="text-align: right">BsmtUnfSF</th>
      <th style="text-align: right">BsmtFullBath</th>
      <th style="text-align: right">BsmtHalfBath</th>
      <th style="text-align: right">TotalBsmtSF</th>
      <th style="text-align: right">Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Gd</td>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">No</td>
      <td style="text-align: left">GLQ</td>
      <td style="text-align: right">1124</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">479</td>
      <td style="text-align: right">1603</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">3206</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">Gd</td>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">725</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">725</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">Gd</td>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">936</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">936</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">Gd</td>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">1595</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">1595</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">Gd</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">Mn</td>
      <td style="text-align: left">GLQ</td>
      <td style="text-align: right">1044</td>
      <td style="text-align: left">Rec</td>
      <td style="text-align: right">382</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">1426</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">Av</td>
      <td style="text-align: left">ALQ</td>
      <td style="text-align: right">755</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">240</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">995</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">No</td>
      <td style="text-align: left">BLQ</td>
      <td style="text-align: right">1033</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">94</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1127</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">Fa</td>
      <td style="text-align: left">No</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">173</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">173</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">No</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">356</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">356</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">0</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">77</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">0</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: right">NA</td>
      <td style="text-align: right">1</td>
    </tr>
  </tbody>
</table>

<p>From the above we see:</p>

<ul>
  <li>2 cases of No Basement (BsmtQual) where BsmtCond is not No Basement - takes values of Fair/Typical</li>
  <li>These cases occur when the BsmtFinType1 is Unfinished. Square footage is positive here.</li>
  <li>5 cases BsmtFinType2 = BsmtFinType1 which shouldn’t happen unless both are NA. Does this happen elsewhere?</li>
  <li>Check that BsmtFinSF1 + BsmtFinSF2 + BsmtUnfSF = TotalBsmtSF</li>
</ul>

<p>First, let’s check for cases of BsmtFinType2 = BsmtFinType1 and check that total SF is correct</p>

<pre><code class="language-r">full %&gt;%
  filter(BsmtFinType2 == BsmtFinType1) %&gt;%
  group_by(BsmtFinType1, BsmtFinType2) %&gt;%
  summarise(BsmtFinSF1 = sum(BsmtFinSF1),
            BsmtFinSF2 = sum(BsmtFinSF2),
            BsmtUnfSF = sum(BsmtUnfSF),
            TotalBsmtSF = sum(TotalBsmtSF),
            ChkTotal = sum(BsmtFinSF1) + sum(BsmtFinSF2) + sum(BsmtUnfSF)) %&gt;%
  knitr::kable()
</code></pre>

<table>
  <thead>
    <tr>
      <th style="text-align: left">BsmtFinType1</th>
      <th style="text-align: left">BsmtFinType2</th>
      <th style="text-align: right">BsmtFinSF1</th>
      <th style="text-align: right">BsmtFinSF2</th>
      <th style="text-align: right">BsmtUnfSF</th>
      <th style="text-align: right">TotalBsmtSF</th>
      <th style="text-align: right">ChkTotal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">BLQ</td>
      <td style="text-align: left">BLQ</td>
      <td style="text-align: right">543</td>
      <td style="text-align: right">119</td>
      <td style="text-align: right">261</td>
      <td style="text-align: right">923</td>
      <td style="text-align: right">923</td>
    </tr>
    <tr>
      <td style="text-align: left">Unf</td>
      <td style="text-align: left">Unf</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">826432</td>
      <td style="text-align: right">826432</td>
      <td style="text-align: right">826432</td>
    </tr>
  </tbody>
</table>

<p>The check passed, so let’s set BsmtFinType2 to NA, BsmtFinSF1 to BsmtFinSF1 + BsmtFinSF2, and BsmtFinSF2 to 0.</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  transform(BsmtFinType2 = ifelse(BsmtFinType2 == BsmtFinType1, NA, BsmtFinType2),
            BsmtFinSF1 = ifelse(BsmtFinType2 == BsmtFinType1, BsmtFinSF1 + BsmtFinSF2, BsmtFinSF1),
            BsmtFinSF2 = ifelse(BsmtFinType2 == BsmtFinType1, 0, BsmtFinSF2))
</code></pre>

<p>Let’s check across the dataset that the total basement SF is correct:</p>

<pre><code class="language-r">full %&gt;%
  filter(TotalBsmtSF != BsmtFinSF1 + BsmtFinSF2 + BsmtUnfSF) %&gt;%
  summarise(Count = n())
</code></pre>

<pre><code>##   Count
## 1     0
</code></pre>

<p>All good then. Let’s perform the updates:</p>

<ul>
  <li>Rows 2-4 BsmtExposure indicate No Basement, however this should be No Exposure</li>
  <li>One row of 77 cases of completely null values - let’s fill these with the default null values</li>
  <li>Rows 8,9 fill in BsmtQual with ‘TA’</li>
  <li>Rows 2-4 BsmtFinType2 set to NA, then convert all NA’s to ‘None’</li>
  <li>NA’s in BsmtFinSF1, BsmtFinSF2, BsmtUnfSF, TotalBsmtSF, BsmtFullBath, BsmtHalfBath should be 0</li>
  <li>NA’s in BsmtQual, BsmtCond, BsmtExposure, BsmtFinType1, BsmtFinType2 should be ‘None’</li>
</ul>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  mutate(BsmtExposure = ifelse(is.na(BsmtExposure) &amp; BsmtQual == 'Gd', 'No', BsmtExposure),
         BsmtFinType2 = ifelse(is.na(BsmtExposure) &amp; BsmtQual == 'Gd', NA, BsmtFinType2),
         
         BsmtFinSF1 = ifelse(is.na(BsmtFinSF1), 0, BsmtFinSF1),
         BsmtFinSF2 = ifelse(is.na(BsmtFinSF2), 0, BsmtFinSF2),
         BsmtUnfSF = ifelse(is.na(BsmtUnfSF), 0, BsmtUnfSF),
         TotalBsmtSF = ifelse(is.na(TotalBsmtSF), 0, TotalBsmtSF),
         BsmtFullBath = ifelse(is.na(BsmtFullBath), 0, BsmtFullBath),
         BsmtHalfBath = ifelse(is.na(BsmtHalfBath), 0, BsmtHalfBath),
         
         BsmtQual = ifelse(is.na(BsmtQual), 'None', BsmtQual),
         BsmtCond = ifelse(is.na(BsmtCond), 'None', BsmtCond),
         BsmtExposure = ifelse(is.na(BsmtExposure), 'None', BsmtExposure),
         BsmtFinType1 = ifelse(is.na(BsmtFinType1), 'None', BsmtFinType1),
         BsmtFinType2 = ifelse(is.na(BsmtFinType2), 'None', BsmtFinType2))
</code></pre>

<p>Now what’s left to fill in?</p>

<pre><code class="language-r">full %&gt;% 
  select(which(sapply(full, function(x)any(is.na(x))))) %&gt;%
  sapply(function(x)sum(ifelse(is.na(x), 1, 0))) %&gt;%
  sort(decreasing=T)
</code></pre>

<pre><code>##       Alley       Fence  MasVnrType  MasVnrArea    MSZoning   Utilities 
##        2721        2348          24          23           4           2 
##  Functional Exterior1st Exterior2nd  Electrical KitchenQual    SaleType 
##           2           1           1           1           1           1
</code></pre>

<h3 id="alley-and-fence">Alley and fence</h3>

<pre><code class="language-r">full %&gt;%
  group_by(Alley, Fence) %&gt;%
  summarise(Count = n()) %&gt;%
  knitr::kable()
</code></pre>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Alley</th>
      <th style="text-align: left">Fence</th>
      <th style="text-align: right">Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Grvl</td>
      <td style="text-align: left">GdPrv</td>
      <td style="text-align: right">5</td>
    </tr>
    <tr>
      <td style="text-align: left">Grvl</td>
      <td style="text-align: left">GdWo</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td style="text-align: left">Grvl</td>
      <td style="text-align: left">MnPrv</td>
      <td style="text-align: right">19</td>
    </tr>
    <tr>
      <td style="text-align: left">Grvl</td>
      <td style="text-align: left">MnWw</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">Grvl</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">91</td>
    </tr>
    <tr>
      <td style="text-align: left">Pave</td>
      <td style="text-align: left">GdPrv</td>
      <td style="text-align: right">3</td>
    </tr>
    <tr>
      <td style="text-align: left">Pave</td>
      <td style="text-align: left">GdWo</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">Pave</td>
      <td style="text-align: left">MnPrv</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: left">Pave</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">72</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">GdPrv</td>
      <td style="text-align: right">110</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">GdWo</td>
      <td style="text-align: right">107</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">MnPrv</td>
      <td style="text-align: right">308</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">MnWw</td>
      <td style="text-align: right">11</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">2185</td>
    </tr>
  </tbody>
</table>

<p>NA means ‘no alley access’ or ‘no fence’ so let’s fill that with ‘None’</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  mutate(Alley = ifelse(is.na(Alley), 'None', Alley),
         Fence = ifelse(is.na(Fence), 'None', Fence))
</code></pre>

<h3 id="mason-veneer">Mason veneer</h3>

<pre><code class="language-r">full %&gt;%
  group_by(MasVnrType, ifelse(is.na(MasVnrArea), 0, 1)) %&gt;%
  summarise(Count = n()) %&gt;%
  knitr::kable()
</code></pre>

<table>
  <thead>
    <tr>
      <th style="text-align: left">MasVnrType</th>
      <th style="text-align: right">ifelse(is.na(MasVnrArea), 0, 1)</th>
      <th style="text-align: right">Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">BrkCmn</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">25</td>
    </tr>
    <tr>
      <td style="text-align: left">BrkFace</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">879</td>
    </tr>
    <tr>
      <td style="text-align: left">None</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1742</td>
    </tr>
    <tr>
      <td style="text-align: left">Stone</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">249</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">23</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
    </tr>
  </tbody>
</table>

<p>Fill this in:</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  mutate(MasVnrType = ifelse(is.na(MasVnrType), 'None', MasVnrType),
         MasVnrArea = ifelse(is.na(MasVnrArea), 0, MasVnrArea))
</code></pre>

<h3 id="mszoning">MSZoning</h3>

<p>Getting the distribution of MSZoning, we see there are 4 NA’s here:</p>

<pre><code class="language-r">full %&gt;%
  group_by(MSZoning) %&gt;%
  summarise(Count = n()) %&gt;%
  knitr::kable()
</code></pre>

<table>
  <thead>
    <tr>
      <th style="text-align: left">MSZoning</th>
      <th style="text-align: right">Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">C (all)</td>
      <td style="text-align: right">25</td>
    </tr>
    <tr>
      <td style="text-align: left">FV</td>
      <td style="text-align: right">139</td>
    </tr>
    <tr>
      <td style="text-align: left">RH</td>
      <td style="text-align: right">26</td>
    </tr>
    <tr>
      <td style="text-align: left">RL</td>
      <td style="text-align: right">2265</td>
    </tr>
    <tr>
      <td style="text-align: left">RM</td>
      <td style="text-align: right">460</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">4</td>
    </tr>
  </tbody>
</table>

<p>Now, let’s see what the most common value of MSZoning is per MSSubClass, and select only the MSSubClass where MSZoning is NA.</p>

<pre><code class="language-r">Mode &lt;- function(x) {
  ux &lt;- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}

full %&gt;%
  group_by(MSSubClass) %&gt;%
  summarise(AvgZoning = Mode(MSZoning)) %&gt;%
  inner_join(
    full %&gt;%
      filter(is.na(MSZoning)) %&gt;%
      distinct(),
    by = "MSSubClass"
  ) %&gt;%
  select(MSSubClass, AvgZoning) %&gt;%
  distinct()
</code></pre>

<pre><code>## # A tibble: 3 × 2
##   MSSubClass AvgZoning
##        &lt;int&gt;     &lt;chr&gt;
## 1         20        RL
## 2         30        RM
## 3         70        RM
</code></pre>

<p>Let’s update the values with this:</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  mutate(MSZoning = ifelse(is.na(MSZoning), ifelse(MSSubClass == 20, 'RL', 'RM'), MSZoning))
</code></pre>

<p>Utilities Functional Exterior1st Exterior2nd Electrical KitchenQual SaleType</p>

<h3 id="the-rest">The rest</h3>

<pre><code class="language-r">full %&gt;%
  filter(is.na(Utilities) |
           is.na(Functional) |
           is.na(Exterior1st) |
           is.na(Exterior2nd) |
           is.na(Electrical) |
           is.na(KitchenQual) |
           is.na(SaleType)) %&gt;%
  group_by(Utilities, Functional, Exterior1st, Exterior2nd, Electrical, KitchenQual, SaleType) %&gt;%
  summarise(Count = n()) %&gt;%
  knitr::kable()
</code></pre>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Utilities</th>
      <th style="text-align: left">Functional</th>
      <th style="text-align: left">Exterior1st</th>
      <th style="text-align: left">Exterior2nd</th>
      <th style="text-align: left">Electrical</th>
      <th style="text-align: left">KitchenQual</th>
      <th style="text-align: left">SaleType</th>
      <th style="text-align: right">Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">AllPub</td>
      <td style="text-align: left">Mod</td>
      <td style="text-align: left">Wd Sdng</td>
      <td style="text-align: left">Wd Sdng</td>
      <td style="text-align: left">SBrkr</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">COD</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">AllPub</td>
      <td style="text-align: left">Typ</td>
      <td style="text-align: left">Plywood</td>
      <td style="text-align: left">Plywood</td>
      <td style="text-align: left">SBrkr</td>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">AllPub</td>
      <td style="text-align: left">Typ</td>
      <td style="text-align: left">VinylSd</td>
      <td style="text-align: left">VinylSd</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">Gd</td>
      <td style="text-align: left">WD</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">AllPub</td>
      <td style="text-align: left">Typ</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">SBrkr</td>
      <td style="text-align: left">Fa</td>
      <td style="text-align: left">WD</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">AllPub</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">AsbShng</td>
      <td style="text-align: left">VinylSd</td>
      <td style="text-align: left">FuseA</td>
      <td style="text-align: left">Fa</td>
      <td style="text-align: left">WD</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">AllPub</td>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">Wd Sdng</td>
      <td style="text-align: left">Wd Sdng</td>
      <td style="text-align: left">SBrkr</td>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">COD</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">Min1</td>
      <td style="text-align: left">Wd Sdng</td>
      <td style="text-align: left">Wd Sdng</td>
      <td style="text-align: left">FuseA</td>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">ConLD</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">NA</td>
      <td style="text-align: left">Min2</td>
      <td style="text-align: left">BrkFace</td>
      <td style="text-align: left">BrkFace</td>
      <td style="text-align: left">FuseA</td>
      <td style="text-align: left">TA</td>
      <td style="text-align: left">WD</td>
      <td style="text-align: right">1</td>
    </tr>
  </tbody>
</table>

<p>Let’s fill the rest in with the most common value</p>

<pre><code class="language-r">full &lt;-
  full %&gt;%
  mutate(Utilities = ifelse(is.na(Utilities), Mode(Utilities), Utilities),
         Functional = ifelse(is.na(Functional), Mode(Functional), Functional),
         Exterior1st = ifelse(is.na(Exterior1st), Mode(Exterior1st), Exterior1st),
         Exterior2nd = ifelse(is.na(Exterior2nd), Mode(Exterior2nd), Exterior2nd),
         Electrical = ifelse(is.na(Electrical), Mode(Electrical), Electrical),
         KitchenQual = ifelse(is.na(KitchenQual), Mode(KitchenQual), KitchenQual),
         SaleType = ifelse(is.na(SaleType), Mode(SaleType), SaleType))
</code></pre>

<h3 id="update-the-train-and-test-data">Update the train and test data</h3>

<p>Now that we have fixed the missing values in the train and test data, we may update the original datasets so that we are ready to begin the analysis.</p>

<pre><code class="language-r">t &lt;- nrow(train)
f &lt;- nrow(full)

SP &lt;- train$SalePrice

train &lt;- full[1:t,]
test &lt;- full[t+1:f,]

train$SalePrice &lt;- SP
</code></pre>

<p>We are now ready to do some exploratory analysis.</p>

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev disabled"><a>&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next disabled"><a>Next &rarr;</a>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  
  <div class="span4">
    <h4>Published</h4>
    <div class="date"><span>17 April 2017</span></div>

  
    <h4>Tags</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags.html#kaggle-ref">kaggle <span>1</span></a></li>
    
  



    </ul>
    
  </div>
</div>


      </div>

      <footer>
        <p>&copy; Name Lastname 2012 
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div> <!-- /container -->

    



  </body>
</html>

